(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[882],{355:function(e,t,r){Promise.resolve().then(r.bind(r,6348))},9376:function(e,t,r){"use strict";var n=r(5475);r.o(n,"useParams")&&r.d(t,{useParams:function(){return n.useParams}}),r.o(n,"useRouter")&&r.d(t,{useRouter:function(){return n.useRouter}}),r.o(n,"useSearchParams")&&r.d(t,{useSearchParams:function(){return n.useSearchParams}})},6348:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return d}});var n=r(7437),s=r(2265),a=r(9376),i=r(2381);let o=()=>{let[e,t]=(0,s.useState)(null),[r,n]=(0,s.useState)(!1),[a,i]=(0,s.useState)(null);return(0,s.useEffect)(()=>{let e=new WebSocket("wss://".concat(window.location.host));return e.onopen=()=>{n(!0),t(e)},e.onclose=()=>{n(!1),t(null)},e.onerror=e=>{i(e)},()=>{e.close()}},[]),{socket:e,isConnected:r,error:a}},l=e=>{let[t,r]=(0,s.useState)(!1),n=(0,s.useRef)(null);return{isRecording:t,startRecording:async()=>{let t=new MediaRecorder(await navigator.mediaDevices.getUserMedia({audio:!0}));n.current=t,t.ondataavailable=t=>{e(t.data)},t.start(),r(!0)},stopRecording:()=>{n.current&&(n.current.stop(),r(!1))}}};var c=r(279);function u(e){let{onFilesChange:t}=e,[r,a]=(0,s.useState)([]),[i,o]=(0,s.useState)([]);return(0,n.jsxs)("div",{className:"w-full max-w-2xl",children:[(0,n.jsx)("h2",{className:"text-2xl font-bold",children:"Images"}),(0,n.jsx)("div",{className:"mt-4",children:(0,n.jsx)(c.I,{type:"file",multiple:!0,onChange:e=>{if(e.target.files){let r=Array.from(e.target.files);a(e=>{let n=[...e,...r];return t(n),n});let n=r.map(e=>URL.createObjectURL(e));o(e=>[...e,...n])}}})}),(0,n.jsx)("div",{className:"mt-4 grid grid-cols-3 gap-4",children:i.map((e,t)=>(0,n.jsx)("img",{src:e,alt:"preview ".concat(t),className:"w-full h-auto"},t))})]})}function d(){let e=(0,a.useRouter)(),{isConnected:t,error:r,socket:c}=o(),[d,f]=(0,s.useState)(""),[m,g]=(0,s.useState)([]),{isRecording:x,startRecording:h,stopRecording:p}=l(e=>{c&&c.readyState===WebSocket.OPEN&&c.send(e)});(0,s.useEffect)(()=>{c&&(c.onmessage=e=>{let t=JSON.parse(e.data);t.transcript&&f(e=>e+t.transcript)})},[c]);let b=async()=>{let t=new FormData;t.append("transcription",d),m.forEach(e=>{t.append("images",e)});let r=await fetch("/api/generate-article",{method:"POST",body:t}),n=await r.json();e.push("/article?article=".concat(n.article))};return(0,n.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-screen p-8",children:[(0,n.jsx)("h1",{className:"text-4xl font-bold",children:"Enregistrement en cours..."}),(0,n.jsxs)("p",{className:"mt-4 text-lg",children:["\xc9tat de la connexion: ",t?"Connect\xe9":"D\xe9connect\xe9"]}),r&&(0,n.jsxs)("p",{className:"text-red-500",children:["Erreur: ",JSON.stringify(r)]}),(0,n.jsx)("div",{className:"mt-8",children:(0,n.jsx)(i.z,{onClick:()=>{x?p():h()},size:"lg",disabled:!t,children:x?"Arr\xeater l'enregistrement":"Commencer l'enregistrement"})}),(0,n.jsxs)("div",{className:"mt-8 w-full max-w-2xl",children:[(0,n.jsx)("h2",{className:"text-2xl font-bold",children:"Transcription"}),(0,n.jsx)("p",{className:"mt-4 text-lg",children:d})]}),(0,n.jsx)("div",{className:"mt-8 w-full max-w-2xl",children:(0,n.jsx)(u,{onFilesChange:g})}),(0,n.jsx)("div",{className:"mt-8",children:(0,n.jsx)(i.z,{onClick:b,size:"lg",disabled:!d,children:"G\xe9n\xe9rer l'article"})})]})}},2381:function(e,t,r){"use strict";r.d(t,{z:function(){return c}});var n=r(7437),s=r(2265),a=r(7495),i=r(535),o=r(3448);let l=(0,i.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=s.forwardRef((e,t)=>{let{className:r,variant:s,size:i,asChild:c=!1,...u}=e,d=c?a.g7:"button";return(0,n.jsx)(d,{className:(0,o.cn)(l({variant:s,size:i,className:r})),ref:t,...u})});c.displayName="Button"},279:function(e,t,r){"use strict";r.d(t,{I:function(){return i}});var n=r(7437),s=r(2265),a=r(3448);let i=s.forwardRef((e,t)=>{let{className:r,type:s,...i}=e;return(0,n.jsx)("input",{type:s,className:(0,a.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",r),ref:t,...i})});i.displayName="Input"},3448:function(e,t,r){"use strict";r.d(t,{cn:function(){return a}});var n=r(1994),s=r(3335);function a(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,s.m6)((0,n.W)(t))}}},function(e){e.O(0,[569,971,117,744],function(){return e(e.s=355)}),_N_E=e.O()}]);